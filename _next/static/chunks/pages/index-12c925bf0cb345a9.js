(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3720:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return L}});var i=n(9008),a=n(8357),s=n(7294);var r=n(5893);const o=(0,s.createContext)({width:0,height:0});function c({children:e}){const{width:t=0,height:n=0}=function(){const{0:e,1:t}=(0,s.useState)({width:void 0,height:void 0});return(0,s.useEffect)((()=>{function e(){t({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e,{passive:!0}),e(),()=>window.removeEventListener("resize",e)}),[]),e}();return(0,r.jsx)(o.Provider,{value:{width:t,height:n},children:e})}function l(){return(0,s.useContext)(o)}const d=(0,s.createContext)({canvas:void 0,setCanvas:()=>{}});function h({children:e}){const{0:t,1:n}=(0,s.useState)();return(0,r.jsx)(d.Provider,{value:{canvas:t,setCanvas:n},children:e})}function u(){return(0,s.useContext)(d)}const f=(0,s.createContext)({isLoaded:!1,setIsLoaded:()=>{}});function x({children:e}){const{0:t,1:n}=(0,s.useState)(!1);return(0,r.jsx)(f.Provider,{value:{isLoaded:t,setIsLoaded:n},children:e})}function v(){return(0,s.useContext)(f)}var w=n(6010),p=n(6893),g=n(2777),m=n(3162);function j(){const{canvas:e}=u(),{setIsLoaded:t}=v(),{width:n,height:i}=l();return{loadFile:(0,s.useCallback)((a=>{if(!a.currentTarget.files)return;if(!n||!i)return;const s=a.currentTarget.files[0];if(s&&e)if("application/json"===s.type){var r=new FileReader;r.readAsText(s,"UTF-8"),r.onload=function(n){var i;e.loadFromJSON(null===n||void 0===n||null===(i=n.target)||void 0===i?void 0:i.result,(function(){e.renderAll(),t(!0)}))}}else if("image/png"===s.type||"image/jpeg"==s.type){const a=new FileReader;a.onload=function(a){var s;const r=new Image;r.src=null===a||void 0===a||null===(s=a.target)||void 0===s?void 0:s.result,r.onload=function(){let a=new g.fabric.Image(r);const s=function(e,t){return(n=e).height>n.width?t.width/e.width:t.height/e.height;var n}(r,{width:n,height:i});a.set({angle:0,padding:0,height:r.height,width:r.width,scaleX:s,scaleY:s}),e.centerObject(a),e.add(a),e.renderAll(),t(!0)}},a.readAsDataURL(s)}}),[e]),exportJSON:(0,s.useCallback)((()=>{const t=new Blob([JSON.stringify(e)],{type:"application/json"});(0,m.saveAs)(t,"photo.json")}),[]),clearCanvas:(0,s.useCallback)((()=>{e&&(e.clear(),e.setBackgroundColor("white",(()=>{e.renderAll(),t(!1)})))}),[e])}}var N=n(8373),C=n.n(N);function _(e){const{loadFile:t}=j();return(0,r.jsx)("div",{className:(0,w.Z)("noprint",C().container,e.className),children:(0,r.jsx)("form",{children:(0,r.jsx)("div",{className:C().wrapper,children:(0,r.jsxs)("label",{htmlFor:"file-picker",children:[(0,r.jsx)(p.Re4,{size:"150",className:C().icon}),(0,r.jsx)("input",{id:"file-picker",type:"file",name:"photo",accept:"image/png, image/jpeg, application/JSON",onChange:t,className:"hidden"}),(0,r.jsx)("h4",{className:"cursor-pointer text-gray-800 w-9/12 mx-auto text-center",children:"Tap the icon to pick image or load JSON file"})]})})})})}var k=n(5431),y=n.n(k);function b(e){return(0,r.jsxs)("button",{className:"bg-white hover:bg-gray-100 text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center shadow ".concat(e.className),onClick:e.onClick,children:[e.icon,e.children]})}function F(){const{exportJSON:e,clearCanvas:t}=j(),n=l(),{canvas:i}=u(),a=e=>{if(!i)return;const t=i.getObjects("image")[0];"left"==e?t&&t.left&&(t.left-=10):"right"==e?t&&t.left&&(t.left+=10):"up"==e?t&&t.top&&(t.top-=10):"down"==e&&t&&t.top&&(t.top+=10),t.setCoords(),i.renderAll()},s="undefined"!==typeof n.width&&n.width>769;return(0,r.jsxs)("div",{className:"flex py-2 mx-auto justify-between",children:[(0,r.jsx)(b,{onClick:()=>{t()},children:"Create New"}),(0,r.jsxs)("div",{className:"flex justify-center items-center",children:[(0,r.jsx)(b,{onClick:()=>a("left"),icon:(0,r.jsx)(p.Ao2,{className:"text-gray-800 w-4 h-4"})}),(0,r.jsx)(b,{className:"ml-1",onClick:()=>a("up"),icon:(0,r.jsx)(p.iRh,{className:"text-gray-800 w-4 h-4"})}),(0,r.jsx)(b,{className:"ml-1",onClick:()=>a("down"),icon:(0,r.jsx)(p.tv1,{className:"text-gray-800 w-4 h-4"})}),(0,r.jsx)(b,{className:"ml-1",onClick:()=>a("right"),icon:(0,r.jsx)(p.Rgz,{className:"text-gray-800 w-4 h-4"})})]}),(0,r.jsx)(b,{onClick:e,icon:(0,r.jsx)(p._hL,{className:"text-gray-800 w-4 h-4 ".concat(s&&"mr-2")}),children:s?"Export as JSON":""})]})}function E(){const{setCanvas:e}=u(),{width:t,height:n}=l(),{isLoaded:i}=v(),a=(o={width:t,height:n}).width&&o.height?o.width>769?{width:600,height:900}:o.width>481?{width:400,height:600}:{width:300,height:450}:{width:0,height:0};var o;return(0,s.useEffect)((()=>{if(!t||!n)return;const i=new g.fabric.Canvas("main-canvas",{width:a.width,height:a.height,backgroundColor:"white"});e(i)}),[t,n]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:(0,w.Z)(y().footer,!i&&y().hide,"noprint"),children:(0,r.jsx)("div",{className:y().wrapper,children:(0,r.jsx)(F,{})})}),(0,r.jsx)("div",{className:(0,w.Z)(y().container,!i&&y().hide),children:(0,r.jsx)("canvas",{id:"main-canvas",className:y().canvas})})]})}function P(){const{isLoaded:e}=v();return(0,r.jsxs)("div",{className:"flex flex-col justify-center h-screen",children:[!e&&(0,r.jsx)(_,{}),(0,r.jsx)(E,{})]})}var L=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.default,{children:[(0,r.jsx)("title",{children:"Photo Editor"}),(0,r.jsx)("meta",{name:"description",content:"Just another simple photo editor"}),(0,r.jsx)("meta",{name:"keywords",content:"photo, editor, pwa, app, react, nextjs"})]}),(0,r.jsx)(c,{children:(0,r.jsx)(h,{children:(0,r.jsx)(a.Pd.Provider,{value:{className:"react-icons"},children:(0,r.jsx)(x,{children:(0,r.jsx)(P,{})})})})})]})},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3720)}])},5431:function(e){e.exports={container:"Canvas_container__P_wzQ",footer:"Canvas_footer__ANFEK",wrapper:"Canvas_wrapper__KsAd5",hide:"Canvas_hide__o4V0z",canvas:"Canvas_canvas__4mSeF"}},8373:function(e){e.exports={container:"FilePicker_container__1ePig",icon:"FilePicker_icon__srD8s"}},4960:function(){},6759:function(){},6272:function(){}},function(e){e.O(0,[498,470,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);